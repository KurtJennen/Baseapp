<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping auto-import="true" default-lazy="false">
	<class name="be.luxuryoverdosis.framework.data.to.BatchJobInstance" table="batch_job_instance">
		<id name="id" column="Job_Instance_Id" type="long" unsaved-value="-1" />
		<property name="version" column="Version" type="long"></property>
		<property name="jobName" column="Job_Name" type="string" not-null="true"></property>
		<property name="jobKey" column="Job_Key" type="string" not-null="true"></property>
	</class>
	
	<query name="getAllBatchJobInstanceByJobExecution">
		select bji
		from BatchJobExecution bje
		inner join bje.batchJobInstance bji
		where bje.id = :jobExecutionId
		order by bje.createTime desc
	</query>
	
	<query name="getAllBatchJobInstanceByJobName">
		select new be.luxuryoverdosis.framework.data.to.BatchJobInstance(
			bji.id,
			bji.jobName,
			bje.id,
			bje.version,
			bje.createTime,
			bje.startTime,
			bje.endTime,
			bje.status,
			bje.exitCode,
			bje.exitMessage,
			bje.lastUpdated
		)
		from BatchJobExecution bje
		inner join bje.batchJobInstance bji
		where bji.jobName = :jobName
		order by bje.createTime desc
	</query>
</hibernate-mapping>